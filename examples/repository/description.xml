<description datatypeLibrary="http://www.w3.org/2001/XMLSchema-datatypes" 
             xmlns="http://riddl.org/ns/description/1.0" 
             xmlns:ann="http://riddl.org/ns/annotation/1.0" 
             xmlns:xi="http://www.w3.org/2001/XInclude">

<!--{{{-->
<!-- Messages at root level -->
  <message name="description">
    <parameter name="description" mimetype="text/xml" handler="http://riddl.org/ns/handlers/relaxng">
      <xi:include href="../../ns/description-1_0.rng"/>
    </parameter>
  </message>

  <message name="whiteInformation-request">
    <parameter name="whiteInformation" type="string"/>
  </message>

  <message name="whiteInformation-response">
    <parameter name="list-of-groups" mimetype="text/xml" handler="http://riddl.org/ns/handlers/relaxng">
      <xi:include href="rngs/details-of-service.rng"/>
    </parameter>
  </message>

<!-- Messages at group level -->
  <message name="list-of-groups">
    <parameter name="list-of-groups" mimetype="text/xml" handler="http://riddl.org/ns/handlers/relaxng">
      <xi:include href="rngs/atom.rng"/>
    </parameter>
  </message>

  <message name="create-group">
    <parameter name="name-of-group" type="string"/>
    <parameter name="properties" mimetype="text/xml" handler="http://riddl.org/ns/handlers/relaxng">
      <xi:include href="rngs/properties.rng"/>
    </parameter>
  </message>

  <message name="properties-of-group-request">
    <parameter name="properties" type="string"/>
  </message>

  <message name="properties-of-group-response">
    <parameter name="properties" mimetype="text/xml"/>
  </message>

  <message name="query-input-of-group-request">
    <parameter name="queryInput" type="string"/>
  </message>

  <message name="query-input-of-group-response">
    <parameter name="query-input" mimetype="text/xml"/>
  </message>

  <message name="query-output-of-group-request">
    <parameter name="queryOutput" type="string"/>
  </message>

  <message name="query-output-of-group-response">
    <parameter name="query-output" mimetype="text/xml"/>
  </message>

  <message name="invoke-input-of-group-request">
    <parameter name="invokeInput" type="string"/>
  </message>

  <message name="invoke-input-of-group-response">
    <parameter name="invoke-input" mimetype="text/xml"/>
  </message>

  <message name="invoke-output-of-group-request">
    <parameter name="invokeOutput" type="string"/>
  </message>

  <message name="invoke-output-of-group-response">
    <parameter name="invoke-output" mimetype="text/xml"/>
  </message>

<!-- Messages at subgroup level -->
  <message name="list-of-subgroups">
    <parameter name="list-of-subgroups" mimetype="text/xml" handler="http://riddl.org/ns/handlers/relaxng">
      <xi:include href="rngs/atom.rng"/>
    </parameter>
  </message>

  <message name="create-subgroup">
    <parameter name="name-of-subgroup" type="string"/>
  </message>

<!-- Messages at service level -->
  <message name="list-of-services">
    <parameter name="list-of-services" mimetype="text/xml" handler="http://riddl.org/ns/handlers/relaxng">
      <xi:include href="rngs/atom.rng"/>
    </parameter>
  </message>

  <message name="create-service">
    <parameter name="name-of-service" type="string"/>
    <parameter name="details-of-service" mimetype="text/xml" handler="http://riddl.org/ns/handlers/relaxng">
      <xi:include href="rngs/details-of-service.rng"/>
    </parameter>
  </message>

<!--- Messages at service-detail level -->
  <message name="details-of-service">
    <parameter name="details-of-service" mimetype="text/xml" handler="http://riddl.org/ns/handlers/relaxng">
      <xi:include href="rngs/details-of-service.rng"/>
    </parameter>
  </message>



  <message name="count-entries">
    <parameter name="count" type="string"/>
  </message>

<!--}}}-->

  <resource>
    <request method="riddl" in="*" out="description">
      <ann:label xml:lang="en">Show description</ann:label>
    </request>
    <get in="whiteInformation-request" out="whiteInformation-response">
      <ann:label xml:lang="en">Show white information schema</ann:label>
    </get>
    <resource relative="groups">
      <get in="*" out="list-of-groups"/>
      <post in="create-group"/>

      <resource relative="count"> 
        <get in="*" out="count-entries"/>
      </resource>

      <resource> <!-- Dynamically: name of the group -->
        <get in="properties-of-group-request" out="properties-of-group-response">
          <ann:label xml:lang="en">Show Properties</ann:label>
        </get>
        <get in="query-input-of-group-request" out="query-input-of-group-response">
          <ann:label xml:lang="en">Show queryInput</ann:label>
        </get>
        <get in="query-output-of-group-request" out="query-output-of-group-response">
          <ann:label xml:lang="en">Show queryOutptut</ann:label>
        </get>
        <get in="invoke-input-of-group-request" out="invoke-input-of-group-response">
          <ann:label xml:lang="en">Show invokeInput</ann:label>
        </get>
        <get in="invoke-output-of-group-request" out="invoke-output-of-group-response">
          <ann:label xml:lang="en">Show invokeOutput</ann:label>
        </get>
        <get in="*" out="list-of-subgroups"/>
        <post in="create-subgroup"/>
        <put in="create-group"/>
        <delete in="*"/>
      
        <resource relative="count"> 
          <get in="*" out="count-entries"/>
        </resource>

        <resource> <!-- Dynamically: name of subgroup -->
          <get in="*" out="list-of-services"/>
          <post in="create-service"/>
          <put in="create-subgroup"/>
          <delete in="*"/>

          <resource relative="count"> 
            <get in="*" out="count-entries"/>
          </resource>

          <resource> <!-- Dynamically: name of service -->
            <get in="*" out="details-of-service"/>
            <put in="create-service"/>
            <delete in="*"/>
          </resource>
        </resource>
      </resource>
    </resource>
  </resource>  

</description>
