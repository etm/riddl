#!/usr/bin/ruby
require '../../lib/ruby/client'

library = Riddl::Client.new("http://localhost:9292/","description.xml")
books = library.resource("/books/")
stime = Time.now.to_f
nums = 1
# Watch the power
nums.times do
  status, res = books.request :get => [
    Riddl::Header.new("Library",7),
    Riddl::Parameter::Simple.new("author","mangler"),
    Riddl::Parameter::Simple.new("title","12")
  ]
  res.each do |r|
    puts r.value.read
  end
end  
puts "#{nums} requests done: #{Time.now.to_f - stime} seconds"
