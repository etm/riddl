<?xml version="1.0"?>

<domain-description  xmlns="http://rescue.org/ns/domain/0.2"
            xmlns:domain="http://rescue.org/ns/domain/0.2"
            xmlns:rng="http://relaxng.org/ns/structure/1.0">
  <properties>
<!-- {{{ -->
    <rng:element name="property_A">
      <caption lang="en">Porperty A</caption>
      <caption lang="de">Eigenschaft A</caption>
      <rng:data type="positiveInteger"/>
    </rng:element>
    <rng:element name="property_B">
      <caption lang="en">Porperty B</caption>
      <caption lang="de">Eigenschaft B</caption>
      <rng:data type="positiveInteger"/>
    </rng:element>
    <rng:element name="property_C">
      <caption lang="en">Porperty C</caption>
      <caption lang="de">Eigenschaft C</caption>
      <rng:data type="positiveInteger"/>
    </rng:element>
<!-- }}} -->
  </properties>
  <operations>
    <operation name="no_params" short="" xmlns="http://rescue.org/ns/controlflow/0.2">
<!-- {{{ -->  
      <data-elements/>
      <execute>
        <call id="no_params" endpoint="resource_path" service-operation="no_params"/>
      </execute>
      <compensate/>
      <undo/>
      <redo/>
      <suspend/>
      <abort/>
<!-- }}} -->   
    </operation>
    <operation name="simple" short="" xmlns="http://rescue.org/ns/controlflow/0.2">
<!-- {{{ -->  
      <data-elements/>
      <execute>
        <call id="simple_operation" endpoint="resource_path" service-operation="simple">
          <input name="wait" message-parameter="wait">
            <domain:caption lang="en">Wait</domain:caption>
            <domain:caption lang="de">Warte</domain:caption>
            <rng:data type="positiveInteger"/>
          </input>
          <output name="simple_output" message-parameter="simple_class_output">
            <domain:caption lang="en">Simple class ouput</domain:caption>
            <domain:caption lang="en">Einfache Klasse Ausgabe</domain:caption>
            <rng:data type="positiveInteger"/>
          </output>
        </call>
      </execute>
      <compensate/>
      <undo/>
      <redo/>
      <suspend/>
      <abort/>
<!-- }}} -->   
    </operation>
    <operation name="complex" short="" xmlns="http://rescue.org/ns/controlflow/0.2">
<!-- {{{ --> 
      <data-elements>
        <wait_internal>4</wait_internal>
      </data-elements>
      <endpoints>
        <timeout>http://www.pri.univie.ac.at/~mangler/services/timeout.php</timeout>
      </endpoints>
      <execute>
        <call id="native_http" endpoint="timeout" http-method="post">
          <input name="timeout" variable="wait_internal">
            <domain:caption lang="en">Wait</domain:caption>
            <domain:caption lang="de">Warte</domain:caption>
            <rng:data type="positiveInteger"/>
          </input>
        </call>
        <manipulate id="divide_wait">
          <variable context="wait_internal" local="number"/>
          number = number / 2
        </manipulate>
        <call id="simple_operation" endpoint="resource_path" service-operation="simple">
          <input name="wait" variable="wait_internal">
            <domain:caption lang="en">Wait</domain:caption>
            <domain:caption lang="de">Warte</domain:caption>
            <rng:data type="positiveInteger"/>
          </input>
          <output name="simple_class_output" message-parameter="complex_class_output">
            <domain:caption lang="en">Complex class ouput</domain:caption>
            <domain:caption lang="en">Komplexe Klasse Ausgabe</domain:caption>
            <rng:data type="positiveInteger"/>
          </output>
        </call>
      </execute>
      <compensate/>
      <undo/>
      <redo/>
      <suspend/>
      <abort/>
<!-- }}} -->   
    </operation>
    <operation name="abstract" short="" xmlns="http://rescue.org/ns/controlflow/0.2">
<!-- {{{ -->  
      <data-elements>
        <complex_out/>
      </data-elements>
      <endpoints/>
      <execute>
        <call id="call_complex" endpoint="resource_path" service-operation="complex">
          <output name="complex_class_output" variable="complex_out"/>
        </call>
        <call id="call_simple" endpoint="resource_path"  service-operation="simple">
          <input name="wait" message-parameter="abstract_input">
            <domain:caption lang="en">Wait</domain:caption>
            <domain:caption lang="de">Warte</domain:caption>
            <rng:data type="positiveInteger"/>
          </input>
        </call>
        <manipulate id="double_class_out">
          <variable output-parameter="abstract_output" local="a_out"/>
          <variable context="complex_out" local="co"/>
          a_out = co *2
        </manipulate>
      </execute>
      <compensate/>
      <undo/>
      <redo/>
      <suspend/>
      <abort/>
<!-- }}} -->  
    </operation>
    <operation name="loop" short="" xmlns="http://rescue.org/ns/controlflow/0.2">
<!-- {{{ --> 
      <data-elements>
        <loop_count>1</loop_count>
      </data-elements>
      <endpoints/>
      <execute>
        <loop>
          <condition test="loop_count" comparator="&gt;" value="0"/>
          <call id="class_loop" endpoint="resource_path" service-operation="simple">
            <input name="wait" message-parameter="loop_wait">
              <domain:caption lang="en">Wait</domain:caption>
              <domain:caption lang="de">Warte</domain:caption>
              <rng:data type="positiveInteger"/>
            </input>
            <output name="simple_output" message-parameter="loop_output">
              <domain:caption lang="en">Loop class ouput</domain:caption>
              <domain:caption lang="en">Loop Klasse Ausgabe</domain:caption>
              <rng:data type="positiveInteger"/>
            </output>
          </call>
          <manipulate id="reduce_counter">
            <variable context="loop_count" local="count"/>
            count -= 1
          </manipulate>
        </loop>
        <call id="instance_loop" endpoint="resource_path" service-operation="loop">
          <input name="wait" message-parameter="loop_wait">
            <domain:caption lang="en">Wait</domain:caption>
            <domain:caption lang="de">Warte</domain:caption>
            <rng:data type="positiveInteger"/>
          </input>
          <input name="cycles" message-parameter="loop_cycles">
            <domain:caption lang="en">Cycles</domain:caption>
            <domain:caption lang="de">Umläufe</domain:caption>
            <rng:data type="positiveInteger"/>
          </input>
          <output name="loop_count" message-parameter="counted_loops">
            <domain:caption lang="en">Number of loops</domain:caption>
            <domain:caption lang="en">Anzhal der Durchläufe</domain:caption>
            <rng:data type="positiveInteger"/>
          </output>
        </call>
        <manipulate id="only_once">
          <variable input-parameter="wait" local="wait"/>
          <variable output-parameter="wait_seconds" local="ws"/>
          <variable context="loop_count" local="lc"/>
          ws = (wait *  lc)
        </manipulate>
      </execute>
      <compensate/>
      <undo/>
      <redo/>
      <suspend/>
      <abort/>
<!-- }}} -->  
    </operation>
    <operation name="parallel" short="" xmlns="http://rescue.org/ns/controlflow/0.2">
<!-- {{{ --> 
      <data-elements/>
      <endpoints>
        <timeout>http://www.pri.univie.ac.at/~mangler/services/timeout.php</timeout>
      </endpoints>
      <execute>
        <parallel>
          <parallel_branch>
            <call id="native" endpoint="timeout" http-method="post">
              <input name="wait" value="3"/>
            </call>
          </parallel_branch>
          <parallel_branch>
            <call id="complex" endpoint="resource_path" service-operation="complex">
              <output name="complex_class_output" message-parameter="parallel_complex_output">
                <domain:caption lang="en">Complex class ouput</domain:caption>
                <domain:caption lang="en">Komplexe Klasse Ausgabe</domain:caption>
                <rng:data type="positiveInteger"/>
              </output>
            </call>
          </parallel_branch>
          <parallel_branch>
            <call id="parallel" endpoint="resource_path" service-operation="parallel">
              <input name="wait" message-parameter="wait">
                <domain:caption lang="en">Wait</domain:caption>
                <domain:caption lang="de">Warte</domain:caption>
                <rng:data type="positiveInteger"/>
              </input>
              <output name="parallel_class_output" message-parameter="parallel_parallel_output">
                <domain:caption lang="en">Parallel class ouput</domain:caption>
                <domain:caption lang="en">Parallele Instanz Ausgabe</domain:caption>
                <rng:data type="positiveInteger"/>
              </output>
            </call>
          </parallel_branch>
        </parallel>
      </execute>
      <compensate/>
      <undo/>
      <redo/>
      <suspend/>
      <abort/>
<!-- }}} -->  
    </operation>
  </operations>
</domain-description>

