<?xml version="1.0"?>

<service-description xmlns="http://rescue.org/ns/service/0.2"
                 xmlns:xsl="http://www.w3.org/1999/XSL/Transform">
  <properties xmlns="http://rescue.org/ns/properties/0.2">
    <property_A>17</property_A>
    <property_B>47</property_B>
    <property_C>11</property_C>
  </properties>
  <operations xmlns="http://rescue.org/ns/controlflow/0.2">
    <no_params>
      <endpoints>
        <ep>http://www.pri.univie.ac.at/~mangler/services/timeout.php</ep>
      </endpoints>
      <context-variables/>
      <execute>
        <call id="s1_op1" endpoint="ep" http-method="post">
          <input name="timeout" value="2"/>
        </call>
      </execute>
      <compensate/>
      <undo/>
      <redo/>
      <suspend/>
      <abort/>
    </no_params>
    <simple>
      <endpoints>
        <ep>http://www.pri.univie.ac.at/~mangler/services/timeout.php</ep>
      </endpoints>
      <context-variables>
        <wait>2</wait>
      </context-variables>
      <execute>
        <call id="s1_op1" endpoint="ep" http-method="post">
          <input name="timeout" message-parameter="wait"/>
        </call>
        <manipulate id="set_output">
          <variable output-parameter="simple_output" local="out"/>
          out = 2
        </manipulate>
      </execute>
      <compensate/>
      <undo/>
      <redo/>
      <suspend/>
      <abort/>
    </simple>
    <loop>
      <endpoints>
        <ep>http://www.pri.univie.ac.at/~mangler/services/timeout.php</ep>
      </endpoints>
      <context-variables>
        <loops>2</loops>
        <internal_wait/>
        <internal_count>0</internal_count>
      </context-variables>
      <execute>
        <manipulate id="prepare">
          <variable input-parameter="loop_wait" local="lw"/>
          <variable context="internal_wait" local="iw"/>
          <variable context="loops" local="l"/>
          iw = 1
        </manipulate>
        <loop>
          <condition test="loops" comparator="&gt;" value="0"/>
          <call id="timeout" endpoint="ep" http-method="post">
            <input name="timeout" variable="internal_wait"/>
          </call>
          <manipulate id="count">
            <variable context="loops" local="loops"/>
            loops -= 1
          </manipulate>
        </loop>
        <manipulate id="set_ouput">
          <variable output-parameter="counted_loops" local="cl"/>
          <variable context="internal_count" local="count"/>
          cl = count
        </manipulate>
      </execute>
      <compensate/>
      <undo/>
      <redo/>
      <suspend/>
      <abort/>
    </loop>
    <parallel>
      <endpoints>
        <ep>http://www.pri.univie.ac.at/~mangler/services/timeout.php</ep>
      </endpoints>
      <context-variables>
        <wait/>
      </context-variables>
      <execute>
        <manipulate id="prepare">
          <variable input-parameter="wait" local="lw"/>
          <variable output-parameter="parallel_parallel_output" local="po"/>
          <variable context="wait" local="wait"/>
          wait = lw * 2
          po = 0
        </manipulate>
        <parallel>
          <parallel_branch>
            <call id="wait_branch_1" endpoint="ep" http-method="post">
              <input name="timeout" message-parameter="wait"/>
            </call>
          </parallel_branch>
          <parallel_branch>
            <call id="wait_branch_2" endpoint="ep" http-method="post">
              <input name="timeout" message-parameter="wait"/>
            </call>
            <manipulate id="set_output_branch_2">
              <variable output-parameter="parallel_parallel_output" local="po"/>
              <variable context="wait" local="w"/>
              po = w 
            </manipulate>
          </parallel_branch>
        </parallel>
      </execute>
      <compensate/>
      <undo/>
      <redo/>
      <suspend/>
      <abort/>
    </parallel>
  </operations>
</service-description>
